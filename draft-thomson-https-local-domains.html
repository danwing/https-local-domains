<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>HTTPS for Local Domains</title>
<meta content="Martin Thomson" name="author">
<meta content="Dan Wing" name="author">
<meta content="
       This document explores a method for providing secure HTTPS access
to local domains without the need for traditional certificates.
By leveraging local domain names embedded with public keys, this
approach ensures secure communication within a local network. The
method simplifies the setup process and enhances security by avoiding
the complexities of certificate management by using raw public keys.
This solution is particularly beneficial for local services that
require HTTPS access without exposing them to the internet. 
    " name="description">
<meta content="xml2rfc 3.25.0" name="generator">
<meta content="next generation" name="keyword">
<meta content="unicorn" name="keyword">
<meta content="sparkling distributed ledger" name="keyword">
<meta content="draft-thomson-https-local-domains-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.25.0
    Python 3.12.7
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.4
    lxml 5.3.0
    platformdirs 4.3.6
    pycountry 22.3.5
    PyYAML 6.0.1
    requests 2.32.3
    setuptools 70.3.0
    wcwidth 0.2.13
-->
<link href="draft-thomson-https-local-domains.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">HTTPS Local Domains</td>
<td class="right">December 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Thomson &amp; Wing</td>
<td class="center">Expires 9 June 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-thomson-https-local-domains-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-12-06" class="published">6 December 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-06-09">9 June 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Thomson</div>
<div class="org">Mozilla</div>
</div>
<div class="author">
      <div class="author-name">D. Wing, <span class="editor">Ed.</span>
</div>
<div class="org">Cloud Software Group</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">HTTPS for Local Domains</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document explores a method for providing secure HTTPS access
to local domains without the need for traditional certificates.
By leveraging local domain names embedded with public keys, this
approach ensures secure communication within a local network. The
method simplifies the setup process and enhances security by avoiding
the complexities of certificate management by using raw public keys.
This solution is particularly beneficial for local services that
require HTTPS access without exposing them to the internet.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://danwing.github.io/https-local-domains/draft-thomson-https-local-domains.html">https://danwing.github.io/https-local-domains/draft-thomson-https-local-domains.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-thomson-https-local-domains/">https://datatracker.ietf.org/doc/draft-thomson-https-local-domains/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/danwing/https-local-domains">https://github.com/danwing/https-local-domains</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 9 June 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-background" class="internal xref">Background</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-using-real-names" class="internal xref">Using Real Names</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1" class="keepWithNext"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-server-authentication-on-th" class="internal xref">Server Authentication on the Web</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-extended-origins-for-local-" class="internal xref">Extended Origins for Local Domains</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-identifying-servers-as-loca" class="internal xref">Identifying Servers as Local</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-origin-serialization" class="internal xref">Origin Serialization</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-advantages-and-drawbacks" class="internal xref">Advantages and Drawbacks</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-user-involvement" class="internal xref">User Involvement</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-key-changes-key-rotation" class="internal xref">Key Changes (Key Rotation)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-address-changes" class="internal xref">Address Changes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-ergonomics-of-origins" class="internal xref">Ergonomics of Origins</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-operation" class="internal xref">Operation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-server-operation" class="internal xref">Server Operation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-client-operation" class="internal xref">Client Operation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-unique-host-names" class="internal xref">Unique Host Names</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-short-host-names" class="internal xref">Short Host Names</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-raw-public-keys" class="internal xref">Raw Public Keys</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-validation" class="internal xref">Validation</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="auto internal xref">13</a>. <a href="#name-encoding-details" class="internal xref">Encoding Details</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="auto internal xref">14</a>. <a href="#name-identifying-servers-as-local" class="internal xref">Identifying Servers as Local</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a href="#section-14.1" class="auto internal xref">14.1</a>.  <a href="#name-local-domain-names" class="internal xref">Local Domain Names</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a href="#section-14.2" class="auto internal xref">14.2</a>.  <a href="#name-local-ip-addresses" class="internal xref">Local IP Addresses</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-15" class="auto internal xref">15</a>. <a href="#name-operational-considerations" class="internal xref">Operational Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a href="#section-15.1" class="auto internal xref">15.1</a>.  <a href="#name-incremental-deployment" class="internal xref">Incremental Deployment</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a href="#section-15.2" class="auto internal xref">15.2</a>.  <a href="#name-server-identity-change" class="internal xref">Server Identity Change</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#section-16" class="auto internal xref">16</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#section-17" class="auto internal xref">17</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a href="#section-18" class="auto internal xref">18</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.1">
                <p id="section-toc.1-1.18.2.1.1"><a href="#section-18.1" class="auto internal xref">18.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.2">
                <p id="section-toc.1-1.18.2.2.1"><a href="#section-18.2" class="auto internal xref">18.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19">
            <p id="section-toc.1-1.19.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-discussion-points" class="internal xref">Discussion Points</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.1">
                <p id="section-toc.1-1.19.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-dtls" class="internal xref">DTLS</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20">
            <p id="section-toc.1-1.20.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-test-encoding" class="internal xref">Test Encoding</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21">
            <p id="section-toc.1-1.21.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.22">
            <p id="section-toc.1-1.22.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">As more of the web transitions to using HTTPS, users that access
services on their local network are being increasingly marginalized.
Servers that run in local networks often cannot easily get a valid
server certificate.  The majority of devices use unsecured HTTP.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Browsers are progressively reducing the capabilities and features that
are available to origins that use unsecured HTTP.  In particular, new
features (<span>[<a href="#secure-context" class="cite xref">secure-context</a>]</span>) are being developed exclusively for HTTPS
origins.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">Non-HTTPS origins are vulnerable to a range of attacks, so all of this
is easy to understand, however it means that local devices are left
with UI that shows negative security indicators (e.g., 'not secure' on
the URL bar, and diminished access to web features.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">Servers that operate publicly accessible endpoints have few challenges
with getting certificates that allow them to authenticate.  The real
challenge is in giving servers that are less publicly available access
to the same opportunities without compromising the assurances provided
to other servers.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">We could run HTTP over TLS without authenticating the server
<span>[<a href="#RFC8164" class="cite xref">RFC8164</a>]</span>, which would provide some of the confidentiality and
privacy benefits of HTTPS.  However, aside from the exposure to
man-in-the-middle attack, a site using <span>[<a href="#RFC8164" class="cite xref">RFC8164</a>]</span> doesn’t gain an
HTTPS origin.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">What is really needed is a way to use HTTPS proper.<a href="#section-1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="background">
<section id="section-2">
      <h2 id="name-background">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-background" class="section-name selfRef">Background</a>
      </h2>
<div id="using-real-names">
<section id="section-2.1">
        <h3 id="name-using-real-names">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-using-real-names" class="section-name selfRef">Using Real Names</a>
        </h3>
<p id="section-2.1-1">The best option for a device that is installed in a local network
might be to use a genuine domain name.  The vendor of a device could
run a service that assigns a unique name from the global DNS namespace
to the device, such as &lt;deviceID&gt;.devices.example.com. Mozilla’s IOT
Gateway does exactly this, and this is a pattern that is emerging as
best practice.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">The way that this works is that a service, often operated by the
device vendor, provides devices with a unique identity. Typically,
this is a subdomain of a domain owned by that vendor. The service
might also further enable the acquisition of certificates for devices.<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<p id="section-2.1-3">A split horizon DNS ensures that requests for that name produce the
correct domain name.  The device vendor might also provision the DNS
for that name, which could improve reachability in some circumstances,
but it could also present a privacy exposure by making network address
assignments publicly accessible. This requires that devices have
access to a means of controlling DNS.  Thus, this is more feasible for
a router that also provides DHCP, but less for other devices.  Even
for a device like a router, a manual configuration of a DNS server
makes the name inaccessible.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<p id="section-2.1-4">A redirect from a friendly name (such as gateway.local) to the full
device name ensures that the device can be reached by typing a more
readily memorable string.  However, there is no way to secure this
redirect: the name that is entered is not unique and therefore a valid
certificate cannot be issued for that name.<a href="#section-2.1-4" class="pilcrow">¶</a></p>
<p id="section-2.1-5">Unlike suggestions to the contrary this does not require that the
device itself be exposed to packets from the internet at large, only
that it be able to reach one particular server on the internet.
Firewall rules could be set to permit only what is necessary to
communicate with a certificate provisioning server.  That server can
proxy requests for certificates; for instance, responding to ACME
challenges as needed and relaying the certificate that is received.
This only requires that the server authenticate devices.
Manufacturers might use keys that are provisioned at the time of
manufacture. If the manufacturer is prepared to provide certificates
to any device, the device might provide credentials when it first
claims an unused name.<a href="#section-2.1-5" class="pilcrow">¶</a></p>
<p id="section-2.1-6">For the device to be accessible from the internet, the device
manufacturer needs to establish and relay communications. This
effectively leads to the device being exposed to the internet, though
the manufacturer might be able to provide some measure of protection
from attacks like denial of service.<a href="#section-2.1-6" class="pilcrow">¶</a></p>
<p id="section-2.1-7">Access to a device using a local
name might be used opportunistically.  For this, HTTP Alternative
Services (<span>[<a href="#RFC7838" class="cite xref">RFC7838</a>]</span>) can be used to provide an alternative route to the device
that does not depend on the external server.  The design of
alternative services ensures that this is used automatically when
available.<a href="#section-2.1-7" class="pilcrow">¶</a></p>
<p id="section-2.1-8">This is a good solution.  But it isn’t without drawbacks.  The names
that are produced are not generally usable by humans as a consequence
of a need to be globally unique.  Some deployments address this by
providing a second service with a memorable name that manages
rendezvous.  That in turn has consequences for privacy, because that
service needs to mediate interactions between users and their devices.<a href="#section-2.1-8" class="pilcrow">¶</a></p>
<p id="section-2.1-9">This approach also imposes an ongoing operational cost on the device
vendor.  With the plethora of things being released with tiny profit
margins, additional operational costs are hard to justify.  Support
from vendors over the lifetime of the device is not guaranteed.  A
vendor that goes out of business is likely to cease operation of a
certificate enrollment service. This might be managed if the device
could be updated with new software that could use a different
service. That only reduces the problem to a previously unsolved one:
that of ensuring continuity of software updates for devices.<a href="#section-2.1-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="server-authentication-on-the-web">
<section id="section-2.2">
        <h3 id="name-server-authentication-on-th">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-server-authentication-on-th" class="section-name selfRef">Server Authentication on the Web</a>
        </h3>
<p id="section-2.2-1">It probably makes sense to take another look at how server
authentication is used on the web.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2">Why does HTTPS need certificates? Unique, memorable names.<a href="#section-2.2-2" class="pilcrow">¶</a></p>
<p id="section-2.2-3">The DNS provides centralized management of names and enforces
uniqueness of those names.  The Web PKI provides security for those
names through the issuance of certificates.<a href="#section-2.2-3" class="pilcrow">¶</a></p>
<p id="section-2.2-4">A name is important for ensuring that a web browser can faithfully
translate user intent into action.  When someone types example.com
into their browser, that name is compared against the name in a
certificate to determine if the server is correct.<a href="#section-2.2-4" class="pilcrow">¶</a></p>
<p id="section-2.2-5">The web origin model cares little that the identity of a server is a
name. A browser cares more about the uniqueness of identity than its
form. The web origin model is built to secure access to the state that
a browser accumulates for an origin, it cares more that the identity
accessing that state remain constant than how it is identified. A
certificate provides a unique anchor for that state, ensuring that
only a single entity controls access to that information.<a href="#section-2.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-3">
      <h2 id="name-conventions-and-definitions">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-3-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="extended-origins-for-local-domains">
<section id="section-4">
      <h2 id="name-extended-origins-for-local-">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-extended-origins-for-local-" class="section-name selfRef">Extended Origins for Local Domains</a>
      </h2>
<p id="section-4-1">The key challenge for local domains is that names are not unique. Any
printer is entitled to claim the name printer.local and use it.  Thus,
any server has a legitimate claim to that name. If we are to make
https://printer.local a viable origin, how do we ensure that it is
unique?<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">Extending the origin makes this possible. A web origin is defined as a
tuple of scheme, host and port. This is a capability that browsers are
building to enable a range of use cases, such as the creation of
separate browsing contexts (see e.g., <span>[<a href="#containers" class="cite xref">containers</a>]</span>). By adding an
additional property to that tuple that cannot be used by any other
server, we ensure that the tuple is able to uniquely identify that
server.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">For this, the public key of the server is ideal.  No other server can
successfully use that identity without undermining the security of the
web and any HTTPS server is always able to provide that information.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">Adding a public key to the origin tuple creates a separation between
origins.  Two servers can claim to be printer.local, but the browser
will ensure that they are distinct entities that are fully isolated
from each other.  Passwords and form data saved for one printer will
not be used by the other printer.  The same separation applies to
permissions, storage, cookies and other state associated with the
origin.<a href="#section-4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="identifying-servers-as-local">
<section id="section-5">
      <h2 id="name-identifying-servers-as-loca">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-identifying-servers-as-loca" class="section-name selfRef">Identifying Servers as Local</a>
      </h2>
<p id="section-5-1">The idea here is to do this only for names that are not inherently
unique. Domain names like example.com are unique and therefore would
not get this treatment.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">Servers with .local (<span>[<a href="#RFC6762" class="cite xref">RFC6762</a>]</span>), .home.arpa (<span>[<a href="#RFC8375" class="cite xref">RFC8375</a>]</span>), or
.internal <span>[<a href="#I-D.davies-internal-tld" class="cite xref">I-D.davies-internal-tld</a>]</span> suffixes will be considered
local.  These names are specifically designed for local use and are
non-unique by design.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">Servers with IPv4 literals from the <span>[<a href="#RFC1918" class="cite xref">RFC1918</a>]</span> address spaces (10/8,
172.16/12, and 192.168/16) will be treated as local. Similarly, hosts
with link-local literals (169.254/16 or fe80::/64) or Unique Local
IPv6 Unicast Addresses (fc00::/7) are considered local.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">Servers on loopback interfaces are local.  This includes the IPv4
literal (127.0.0.1), the host-scope IPv6 literal (::1), and any origin
with the name “localhost”
(<span>[<a href="#I-D.ietf-dnsop-let-localhost-be-localhost" class="cite xref">I-D.ietf-dnsop-let-localhost-be-localhost</a>]</span>).<a href="#section-5-4" class="pilcrow">¶</a></p>
<p id="section-5-5">Address literals might reach a server that can also be reached using a
domain name.  This is not fundamentally different to a server that can
be reached by two different names (for example, servers often respond
to names both with and without a “www” label: https://example.com and
https://www.example.com).  A server that is identified with a URL that
includes a domain name has a different identity to the server that is
identified with a URL that includes an IP address literal, even if the
domain name resolves to that IP address.  Servers with multiple
identities will be able to use this capability to either provide a
secure redirect to a preferred name or to present a different service
to clients.<a href="#section-5-5" class="pilcrow">¶</a></p>
<p id="section-5-6">The names that are identified as local are all non-unique and
therefore not valid targets for certificates. This means that HTTPS
connections to these servers could not otherwise be made using a
genuine Web PKI certificate.<a href="#section-5-6" class="pilcrow">¶</a></p>
<p id="section-5-7">Other means of identifying servers as local might be added in future.<a href="#section-5-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="origin-serialization">
<section id="section-6">
      <h2 id="name-origin-serialization">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-origin-serialization" class="section-name selfRef">Origin Serialization</a>
      </h2>
<p id="section-6-1">The primary drawback of adding more attributes to the origin tuple is
the effect it has on applications that use origin in their processing.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">For instance, the postMessage API uses the origin to describe the
source or destination of messages. The sender of a message identifies
the origin that it expects to receive the message. The recipient of a
message is expected to check that the origin matches their
expectations.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">This proposes a change to the serialization of origins for local
servers so that it includes a hash of the server’s public key
information (SPKI).  This is added to the ASCII and Unicode
serializations of the origin.<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">For example, this might use the underscore convention to add the SPKI
hash to the domain name,
https://_NPNE4IG2GJ4VAL4DCHL64YSM5BII4A2X.printer.local, or it could
use a separator of some sort to partition off space for a key.<a href="#section-6-4" class="pilcrow">¶</a></p>
<p id="section-6-5">TBD: Does this need a new scheme? Is it a new field, or can it be
added to the domain name? What separator would this use? How should
the SPKI hash be encoded (base64url, base32, hex)? How many bits are
enough? Do we need to signal hash function?  Is this a new field at
the end, a change to the name, or something else? Should SPKI go in
the middle to discourage prefix-matching?<a href="#section-6-5" class="pilcrow">¶</a></p>
<p id="section-6-6">Adding a non-backwards compatible serialization for origins makes
these APIs harder to use.  For instance, sending a message to a
printer.local requires learning this value. This is partly
intentional. The space of possible names for local servers is limited,
and the choice of names for devices like printers even more narrowly
limited. Including a server public key in the origin makes it
difficult to correctly guess the name that will cause a message to be
received by the device.  A device can make its name known by sending
its own message to other servers (e.g., <span>[<a href="#mDNS" class="cite xref">mDNS</a>]</span>).<a href="#section-6-6" class="pilcrow">¶</a></p>
<p id="section-6-7">The other potential problem is that .local names are permitted to use
a wider range of characters than domain names.  What sort of
normalization do we do to avoid confusable characters?<a href="#section-6-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="advantages-and-drawbacks">
<section id="section-7">
      <h2 id="name-advantages-and-drawbacks">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-advantages-and-drawbacks" class="section-name selfRef">Advantages and Drawbacks</a>
      </h2>
<p id="section-7-1">The key advantage of this approach is that the extension of origin
allows local services, including those running on the local machine,
to use and benefit from HTTPS.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">There are several drawbacks, each of which needs careful
consideration.<a href="#section-7-2" class="pilcrow">¶</a></p>
<div id="user-involvement">
<section id="section-7.1">
        <h3 id="name-user-involvement">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-user-involvement" class="section-name selfRef">User Involvement</a>
        </h3>
<p id="section-7.1-1">Part of the security of this system involves user awareness.  If
printer.local at home has a password, then moving to a different
network exposes the user to a phishing-type attack where a different
printer.local attempts to retrieve the password for the home printer.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">This is why there is a warning shown on first connection to servers
and an enhanced warning is shown after a name-collision.  It is
possible that other security UX might be enhanced to better signal the
status of local servers. For instance, showing the identicon in the
above examples next to the server’s chosen favicon.  For password
stealing, using a reliable password manager should help. It might be
necessary to include notices warning users about the server identity.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<p id="section-7.1-3">Third-party password managers would need to be enhanced to recognize
the additional information in the origin and properly segment the
namespace. A password manager that looks at window.location.host is
likely to broadcast passwords inappropriately.<a href="#section-7.1-3" class="pilcrow">¶</a></p>
<p id="section-7.1-4">To mitigate this risk we might consider blocking concurrent use of the
same name with different keys if a password manager is installed.
However, I don’t think that we necessarily know that an extension is a
password manager.  This probably reduces to some due diligence with
the help of the addons team.<a href="#section-7.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="key-changes-key-rotation">
<section id="section-7.2">
        <h3 id="name-key-changes-key-rotation">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-key-changes-key-rotation" class="section-name selfRef">Key Changes (Key Rotation)</a>
        </h3>
<p id="section-7.2-1">Devices that rotate keys will gain a new identity, and lose access to
any existing state.  This creates an incentive to avoid changing keys,
which runs counter to most operational practices.  In this case, the
advantages of making HTTPS available would seem to far outweigh the
risk of using a key over long periods.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">It is also possible that a reset of the device might cause keys to be
reset, leading to the more alarming user notice.<a href="#section-7.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="address-changes">
<section id="section-7.3">
        <h3 id="name-address-changes">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-address-changes" class="section-name selfRef">Address Changes</a>
        </h3>
<p id="section-7.3-1">Devices that are identified by their IP address will receive a new
identity when their assigned address changes.  This is a consequence
of extending the origin tuple to include a public key.  This is
intentional: a device might intentionally operate multiple identities
and wish to preserve separation of origins.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ergonomics-of-origins">
<section id="section-7.4">
        <h3 id="name-ergonomics-of-origins">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-ergonomics-of-origins" class="section-name selfRef">Ergonomics of Origins</a>
        </h3>
<p id="section-7.4-1">As outlined in the construction of origins for local servers
<a href="#origin-serialization" class="auto internal xref">Section 6</a>, the ergonomics of an origin that includes a
SPKI hash is not always ideal -- it is not human readable.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
<p id="section-7.4-2">A mitigation for this issue is short names <a href="#short" class="auto internal xref">Section 10</a>.<a href="#section-7.4-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="operation">
<section id="section-8">
      <h2 id="name-operation">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-operation" class="section-name selfRef">Operation</a>
      </h2>
<div id="server-operation">
<section id="section-8.1">
        <h3 id="name-server-operation">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-server-operation" class="section-name selfRef">Server Operation</a>
        </h3>
<p id="section-8.1-1">A server running on a local network (see <a href="#unique" class="auto internal xref">Section 9</a>) uses a unique host
name that includes a hash of its public key.  This unique name is encoded as
described in <a href="#encoding" class="auto internal xref">Section 13</a>.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">The server <span class="bcp14">MAY</span> also advertise its unique name using <span>[<a href="#DNS-SD" class="cite xref">DNS-SD</a>]</span>.  It
<span class="bcp14">MAY</span> also advertise its short name as described in <a href="#short" class="auto internal xref">Section 10</a>.<a href="#section-8.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="client-operation">
<section id="section-8.2">
        <h3 id="name-client-operation">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-client-operation" class="section-name selfRef">Client Operation</a>
        </h3>
<p id="section-8.2-1">When clients connect to such a local domain name or IP address
(<a href="#local" class="auto internal xref">Section 14</a>) using TLS they examine if the domain name starts with a
registered hash identifier in the second label and if the rest of that
label consists of an appropriate-length encoded hash. If those
conditions apply, the client <span class="bcp14">MAY</span> send a TLS ClientHello with the Raw
Public Key extension <span>[<a href="#RFC7250" class="cite xref">RFC7250</a>]</span>. When the client receives the
server's raw public key or certificate, the client checks if the hash
matches the public key received in the TLS ServerHello. If they match,
the client authenticates the TLS connection. If they do not match, the
client behavior falls back to the client's normal handling of the
presented TLS raw public key or certificate (which may well be valid).<a href="#section-8.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="unique">
<section id="section-9">
      <h2 id="name-unique-host-names">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-unique-host-names" class="section-name selfRef">Unique Host Names</a>
      </h2>
<p id="section-9-1">Web browsers and other application clients store per-host state using
the host name, including cached form data such as passwords,
integrated and 3rd party password managers, cookies, and other data.
When a name collision occurs (e.g., the same printer.local name on
two different networks) the client cannot recognize a different host
is being encountered.  While it is possible to extend all of these
clients to extend their index to include the server's public key, this
seems to lack business justification for the engineering effort to
solely improve the user experience (short name, <a href="#short" class="auto internal xref">Section 10</a>) on local networks.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">A unique name can be created by embedding the hash of the public
key into the name itself.  This achieves uniqueness and is also
used by the client to validate the server's public key <a href="#validation" class="auto internal xref">Section 12</a>.
Details on encoding are in <a href="#encoding" class="auto internal xref">Section 13</a>.<a href="#section-9-2" class="pilcrow">¶</a></p>
<p id="section-9-3">To ease clients connecting to these long names, servers <span class="bcp14">SHOULD</span>
advertise their long names on the local network <span>[<a href="#DNS-SD" class="cite xref">DNS-SD</a>]</span>.<a href="#section-9-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="short">
<section id="section-10">
      <h2 id="name-short-host-names">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-short-host-names" class="section-name selfRef">Short Host Names</a>
      </h2>
<p id="section-10-1">Long host names containing encoded public keys are awkward for users. This
section describes how short names can also be advertised by servers and
securely validated by clients, so that the short name is presented to
users while the long name is used to actually connect.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">The server advertises both its (long) unique name and its short
nickname using <span>[<a href="#DNS-SD" class="cite xref">DNS-SD</a>]</span>.  The client connects to the long
name and performs a full TLS handshake and validation
(<a href="#validation" class="auto internal xref">Section 12</a>).  The client then connects to the short nickname and
performs a full TLS handshake. If the same public key was presented by
both TLS connections, the client <span class="bcp14">SHOULD</span> present both the
long name and short name to the user.<a href="#section-10-2" class="pilcrow">¶</a></p>
<p id="section-10-3">The client need only look for matching short name and unique name
within the same TLD domain name (that is, if a unique name is advertised
with a ".local" domain, the client does not need to look for its
accompanying short name within ".internal").<a href="#section-10-3" class="pilcrow">¶</a></p>
<p id="section-10-4">To avoid the problems described in <a href="#unique" class="auto internal xref">Section 9</a>, the TLS data connection
to the printer <span class="bcp14">MUST</span> always use the long name.  Thus, if the client has
validated the short name as described above and a user attempts to
connect to printer.local (by typing or by some other user
interaction), the client <span class="bcp14">MUST</span> connect to the unique name.  The TLS
connection to the short name <span class="bcp14">MUST NOT</span> be used by the client after the
TLS handshake completes and the server <span class="bcp14">MUST</span> terminate the TLS
handshake after the Finished message by sending TLS close_notify.<a href="#section-10-4" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-10-5.1">
          <p id="section-10-5.1.1">Discussion: A short name could be entirely handled on the
  client. The disadvantage to client-side handling is each client
  might choose its own short name (one user chooses "office printer",
  another chooses "downstairs printer", another doesn't bother
  choosing a short name at all). While annoying to manage those
  different names, it is not a severe problem.<a href="#section-10-5.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="rpk">
<section id="section-11">
      <h2 id="name-raw-public-keys">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-raw-public-keys" class="section-name selfRef">Raw Public Keys</a>
      </h2>
<p id="section-11-1">Raw public keys are used in various security protocols to facilitate
authentication without the need for full certificate chains <span>[<a href="#RFC7250" class="cite xref">RFC7250</a>]</span>.
This approach simplifies the certificate exchange process by
transmitting only the necessary public key information.<a href="#section-11-1" class="pilcrow">¶</a></p>
<p id="section-11-2">Certificates are complicated because they involve:<a href="#section-11-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11-3.1">
          <p id="section-11-3.1.1">Managing multiple levels of certificate authorities (CAs).<a href="#section-11-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-11-3.2">
          <p id="section-11-3.2.1">Regular renewal and lifecycle management.<a href="#section-11-3.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-11-3.3">
          <p id="section-11-3.3.1">Establishing and verifying trust with CAs.<a href="#section-11-3.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-11-4">Raw public keys offer a simpler alternative:<a href="#section-11-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11-5.1">
          <p id="section-11-5.1.1">No need for complex certificate chains.<a href="#section-11-5.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-11-5.2">
          <p id="section-11-5.2.1">Using raw public keys allows for direct authentication,
  making it easier to implement and understand.<a href="#section-11-5.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-11-5.3">
          <p id="section-11-5.3.1">Raw public keys use a public key for the lifetime of the device,
   eliminating the need for renewal and longer lifetimes.<a href="#section-11-5.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-11-5.4">
          <p id="section-11-5.4.1">Robust authentication through public key cryptography.<a href="#section-11-5.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-11-6">Using raw public keys can streamline authentication processes while
maintaining high levels of security, making them an attractive
alternative to traditional certificates.<a href="#section-11-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="validation">
<section id="section-12">
      <h2 id="name-validation">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-validation" class="section-name selfRef">Validation</a>
      </h2>
<p id="section-12-1">The client connects to a unique hostname and sends a TLS ClientHello.
As the client only needs the raw public key, the request <span class="bcp14">MAY</span> include
a request for a raw public key <span>[<a href="#RFC7250" class="cite xref">RFC7250</a>]</span>.  The client parses
the returned certificate or raw public key to extract the public key
and compare its hash with the hash contained in the hostname. If
they match, the TLS session continues. If they do not match, the
client might warn the user (as is common today) or simply abandon
the TLS connection.<a href="#section-12-1" class="pilcrow">¶</a></p>
<p id="section-12-2">If a certificate is returned both its 'NotBefore' and 'NotAfter' dates
are ignored for purposes of this specification.<a href="#section-12-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="encoding">
<section id="section-13">
      <h2 id="name-encoding-details">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-encoding-details" class="section-name selfRef">Encoding Details</a>
      </h2>
<p id="section-13-1">The general format is hostname, a period, a digit indicating the hash
algorithm, and then the hash of the server's public key.  The binary
hash output is base32 encoded (<span><a href="https://rfc-editor.org/rfc/rfc4648#section-6" class="relref">Section 6</a> of [<a href="#RFC4648" class="cite xref">RFC4648</a>]</span>) without
trailing "=" padding.  Currently only SHA256 hash is defined with the
value "0" (<a href="#iana" class="auto internal xref">Section 17</a>).  While base32 encoding is specified as uppercase,
implementations should treat uppercase, lowercase, and mixed case
the same.<a href="#section-13-1" class="pilcrow">¶</a></p>
<div class="alignCenter art-abnf art-text artwork" id="section-13-2">
<pre>
friendly-name = 1*63(ALPHA / DIGIT / "-")

hash-algorithm = DIGIT   ; 0=SHA256

base32-digits = "2" / "3" / "4" / "5" / "6" / "7"

hash = 1*62(/ ALPHA / base32-digits )
     ; 62+1 octet limit from RFC1035

encoded-hostname = friendly-name "."
                   hash-algorithm
                   hash
</pre><a href="#section-13-2" class="pilcrow">¶</a>
</div>
<p id="section-13-3">An example encoding is shown in <a href="#test-encoding" class="auto internal xref">Appendix B</a>.<a href="#section-13-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="local">
<section id="section-14">
      <h2 id="name-identifying-servers-as-local">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-identifying-servers-as-local" class="section-name selfRef">Identifying Servers as Local</a>
      </h2>
<p id="section-14-1">This section defines the domain names and IP addresses considered
"local" which clients <span class="bcp14">MAY</span> use with this specification.  Other domain
names and other IP addresses <span class="bcp14">SHOULD NOT</span> be used with this
specification.<a href="#section-14-1" class="pilcrow">¶</a></p>
<div id="local-domain-names">
<section id="section-14.1">
        <h3 id="name-local-domain-names">
<a href="#section-14.1" class="section-number selfRef">14.1. </a><a href="#name-local-domain-names" class="section-name selfRef">Local Domain Names</a>
        </h3>
<p id="section-14.1-1">The following domain name suffixes are considered "local":<a href="#section-14.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.1-2.1">
            <p id="section-14.1-2.1.1">".local" (from <span>[<a href="#mDNS" class="cite xref">mDNS</a>]</span>)<a href="#section-14.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.1-2.2">
            <p id="section-14.1-2.2.1">".home-arpa" (from <span>[<a href="#Homenet" class="cite xref">Homenet</a>]</span>)<a href="#section-14.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.1-2.3">
            <p id="section-14.1-2.3.1">".internal" (from <span>[<a href="#I-D.davies-internal-tld" class="cite xref">I-D.davies-internal-tld</a>]</span>)<a href="#section-14.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.1-2.4">
            <p id="section-14.1-2.4.1">both ".localhost" and "localhost" (Section 6.3 of <span>[<a href="#RFC6761" class="cite xref">RFC6761</a>]</span>)<a href="#section-14.1-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="local-ip-addresses">
<section id="section-14.2">
        <h3 id="name-local-ip-addresses">
<a href="#section-14.2" class="section-number selfRef">14.2. </a><a href="#name-local-ip-addresses" class="section-name selfRef">Local IP Addresses</a>
        </h3>
<p id="section-14.2-1">Additionally, if any host resolves to a local IP address and
connection is made to that address, those are also considered
"local":<a href="#section-14.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.2-2.1">
            <p id="section-14.2-2.1.1">10/8, 172.16/12, and 192.168/16 (from <span>[<a href="#RFC1918" class="cite xref">RFC1918</a>]</span>)<a href="#section-14.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.2-2.2">
            <p id="section-14.2-2.2.1">169.254/16 and fe80::/10 (from <span>[<a href="#RFC3927" class="cite xref">RFC3927</a>]</span> and <span>[<a href="#RFC4291" class="cite xref">RFC4291</a>]</span>)<a href="#section-14.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.2-2.3">
            <p id="section-14.2-2.3.1">fc00::/7 (from <span>[<a href="#RFC4193" class="cite xref">RFC4193</a>]</span>)<a href="#section-14.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.2-2.4">
            <p id="section-14.2-2.4.1">127/8 and ::1/128 (from <span>[<a href="#RFC990" class="cite xref">RFC990</a>]</span> and <span>[<a href="#RFC4291" class="cite xref">RFC4291</a>]</span>)<a href="#section-14.2-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="operational-considerations">
<section id="section-15">
      <h2 id="name-operational-considerations">
<a href="#section-15" class="section-number selfRef">15. </a><a href="#name-operational-considerations" class="section-name selfRef">Operational Considerations</a>
      </h2>
<div id="incremental-deployment">
<section id="section-15.1">
        <h3 id="name-incremental-deployment">
<a href="#section-15.1" class="section-number selfRef">15.1. </a><a href="#name-incremental-deployment" class="section-name selfRef">Incremental Deployment</a>
        </h3>
<p id="section-15.1-1">Where a server's hostname can be configured, a motivated network
administrator can configure server hostnames to comply with this
specification to provide immediate value to supporting clients.<a href="#section-15.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="server-identity-change">
<section id="section-15.2">
        <h3 id="name-server-identity-change">
<a href="#section-15.2" class="section-number selfRef">15.2. </a><a href="#name-server-identity-change" class="section-name selfRef">Server Identity Change</a>
        </h3>
<p id="section-15.2-1">The server's public key is encoded into its domain name.
Changing the public key would also change its domain name -- thus, its
identity as known by client password managers and other configurations
in clients (e.g., printer, SMB share, etc.). As such an identity
change is extremely disruptive, it needs to be avoided.<a href="#section-15.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-16">
      <h2 id="name-security-considerations">
<a href="#section-16" class="section-number selfRef">16. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-16-1">TODO: write more on security considerations<a href="#section-16-1" class="pilcrow">¶</a></p>
<p id="section-16-2">Due to challenges in key rotation, the public/private key pair on a
server needs to stay static. The tradeoff is servers are vulnerable
to their private keys being stolen and an active attacker intercepting
traffic to that server.  The alternatives are to continue using
unencrypted communication to local servers, which is vulnerable to
passive attack, or to condition users to validate self-signed certificates
for local servers. In this case, the
advantages of making HTTPS available would seem to far outweigh the
risk of using a key over long periods.<a href="#section-16-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana">
<section id="section-17">
      <h2 id="name-iana-considerations">
<a href="#section-17" class="section-number selfRef">17. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-17-1">New registry for hash type, 0=SHA256.  Extensions via IETF Action.<a href="#section-17-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-combined-references">
<section id="section-18">
      <h2 id="name-references">
<a href="#section-18" class="section-number selfRef">18. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-18.1">
        <h3 id="name-normative-references">
<a href="#section-18.1" class="section-number selfRef">18.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="DNS-SD">[DNS-SD]</dt>
        <dd>
<span class="refAuthor">Cheshire, S.</span> and <span class="refAuthor">M. Krochmal</span>, <span class="refTitle">"DNS-Based Service Discovery"</span>, <span class="seriesInfo">RFC 6763</span>, <span class="seriesInfo">DOI 10.17487/RFC6763</span>, <time datetime="2013-02" class="refDate">February 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6763">https://www.rfc-editor.org/rfc/rfc6763</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4648">[RFC4648]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span>, <span class="refTitle">"The Base16, Base32, and Base64 Data Encodings"</span>, <span class="seriesInfo">RFC 4648</span>, <span class="seriesInfo">DOI 10.17487/RFC4648</span>, <time datetime="2006-10" class="refDate">October 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4648">https://www.rfc-editor.org/rfc/rfc4648</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7250">[RFC7250]</dt>
        <dd>
<span class="refAuthor">Wouters, P., Ed.</span>, <span class="refAuthor">Tschofenig, H., Ed.</span>, <span class="refAuthor">Gilmore, J.</span>, <span class="refAuthor">Weiler, S.</span>, and <span class="refAuthor">T. Kivinen</span>, <span class="refTitle">"Using Raw Public Keys in Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">RFC 7250</span>, <span class="seriesInfo">DOI 10.17487/RFC7250</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7250">https://www.rfc-editor.org/rfc/rfc7250</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-18.2">
        <h3 id="name-informative-references">
<a href="#section-18.2" class="section-number selfRef">18.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="containers">[containers]</dt>
        <dd>
<span class="refAuthor">Novak, C.</span>, <span class="refTitle">"Put your multiple online personalities in Firefox Multi-Account Containers"</span>, <time datetime="2017-09" class="refDate">September 2017</time>, <span>&lt;<a href="https://blog.mozilla.org/en/products/firefox/introducing-firefox-multi-account-containers/">https://blog.mozilla.org/en/products/firefox/introducing-firefox-multi-account-containers/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Homenet">[Homenet]</dt>
        <dd>
<span class="refAuthor">Pfister, P.</span> and <span class="refAuthor">T. Lemon</span>, <span class="refTitle">"Special-Use Domain 'home.arpa.'"</span>, <span class="seriesInfo">RFC 8375</span>, <span class="seriesInfo">DOI 10.17487/RFC8375</span>, <time datetime="2018-05" class="refDate">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8375">https://www.rfc-editor.org/rfc/rfc8375</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.davies-internal-tld">[I-D.davies-internal-tld]</dt>
        <dd>
<span class="refAuthor">Davies, K.</span> and <span class="refAuthor">A. McConachie</span>, <span class="refTitle">"A Top-level Domain for Private Use"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-davies-internal-tld-01</span>, <time datetime="2024-10-18" class="refDate">18 October 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-davies-internal-tld-01">https://datatracker.ietf.org/doc/html/draft-davies-internal-tld-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-dnsop-let-localhost-be-localhost">[I-D.ietf-dnsop-let-localhost-be-localhost]</dt>
        <dd>
<span class="refAuthor">West, M.</span>, <span class="refTitle">"Let 'localhost' be localhost."</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-dnsop-let-localhost-be-localhost-02</span>, <time datetime="2017-12-18" class="refDate">18 December 2017</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-dnsop-let-localhost-be-localhost-02">https://datatracker.ietf.org/doc/html/draft-ietf-dnsop-let-localhost-be-localhost-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="mDNS">[mDNS]</dt>
        <dd>
<span class="refAuthor">Cheshire, S.</span> and <span class="refAuthor">M. Krochmal</span>, <span class="refTitle">"Multicast DNS"</span>, <span class="seriesInfo">RFC 6762</span>, <span class="seriesInfo">DOI 10.17487/RFC6762</span>, <time datetime="2013-02" class="refDate">February 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6762">https://www.rfc-editor.org/rfc/rfc6762</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1918">[RFC1918]</dt>
        <dd>
<span class="refAuthor">Rekhter, Y.</span>, <span class="refAuthor">Moskowitz, B.</span>, <span class="refAuthor">Karrenberg, D.</span>, <span class="refAuthor">de Groot, G. J.</span>, and <span class="refAuthor">E. Lear</span>, <span class="refTitle">"Address Allocation for Private Internets"</span>, <span class="seriesInfo">BCP 5</span>, <span class="seriesInfo">RFC 1918</span>, <span class="seriesInfo">DOI 10.17487/RFC1918</span>, <time datetime="1996-02" class="refDate">February 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc1918">https://www.rfc-editor.org/rfc/rfc1918</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3927">[RFC3927]</dt>
        <dd>
<span class="refAuthor">Cheshire, S.</span>, <span class="refAuthor">Aboba, B.</span>, and <span class="refAuthor">E. Guttman</span>, <span class="refTitle">"Dynamic Configuration of IPv4 Link-Local Addresses"</span>, <span class="seriesInfo">RFC 3927</span>, <span class="seriesInfo">DOI 10.17487/RFC3927</span>, <time datetime="2005-05" class="refDate">May 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3927">https://www.rfc-editor.org/rfc/rfc3927</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4193">[RFC4193]</dt>
        <dd>
<span class="refAuthor">Hinden, R.</span> and <span class="refAuthor">B. Haberman</span>, <span class="refTitle">"Unique Local IPv6 Unicast Addresses"</span>, <span class="seriesInfo">RFC 4193</span>, <span class="seriesInfo">DOI 10.17487/RFC4193</span>, <time datetime="2005-10" class="refDate">October 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4193">https://www.rfc-editor.org/rfc/rfc4193</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4291">[RFC4291]</dt>
        <dd>
<span class="refAuthor">Hinden, R.</span> and <span class="refAuthor">S. Deering</span>, <span class="refTitle">"IP Version 6 Addressing Architecture"</span>, <span class="seriesInfo">RFC 4291</span>, <span class="seriesInfo">DOI 10.17487/RFC4291</span>, <time datetime="2006-02" class="refDate">February 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4291">https://www.rfc-editor.org/rfc/rfc4291</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6761">[RFC6761]</dt>
        <dd>
<span class="refAuthor">Cheshire, S.</span> and <span class="refAuthor">M. Krochmal</span>, <span class="refTitle">"Special-Use Domain Names"</span>, <span class="seriesInfo">RFC 6761</span>, <span class="seriesInfo">DOI 10.17487/RFC6761</span>, <time datetime="2013-02" class="refDate">February 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6761">https://www.rfc-editor.org/rfc/rfc6761</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6762">[RFC6762]</dt>
        <dd>
<span class="refAuthor">Cheshire, S.</span> and <span class="refAuthor">M. Krochmal</span>, <span class="refTitle">"Multicast DNS"</span>, <span class="seriesInfo">RFC 6762</span>, <span class="seriesInfo">DOI 10.17487/RFC6762</span>, <time datetime="2013-02" class="refDate">February 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6762">https://www.rfc-editor.org/rfc/rfc6762</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7838">[RFC7838]</dt>
        <dd>
<span class="refAuthor">Nottingham, M.</span>, <span class="refAuthor">McManus, P.</span>, and <span class="refAuthor">J. Reschke</span>, <span class="refTitle">"HTTP Alternative Services"</span>, <span class="seriesInfo">RFC 7838</span>, <span class="seriesInfo">DOI 10.17487/RFC7838</span>, <time datetime="2016-04" class="refDate">April 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7838">https://www.rfc-editor.org/rfc/rfc7838</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8164">[RFC8164]</dt>
        <dd>
<span class="refAuthor">Nottingham, M.</span> and <span class="refAuthor">M. Thomson</span>, <span class="refTitle">"Opportunistic Security for HTTP/2"</span>, <span class="seriesInfo">RFC 8164</span>, <span class="seriesInfo">DOI 10.17487/RFC8164</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8164">https://www.rfc-editor.org/rfc/rfc8164</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8375">[RFC8375]</dt>
        <dd>
<span class="refAuthor">Pfister, P.</span> and <span class="refAuthor">T. Lemon</span>, <span class="refTitle">"Special-Use Domain 'home.arpa.'"</span>, <span class="seriesInfo">RFC 8375</span>, <span class="seriesInfo">DOI 10.17487/RFC8375</span>, <time datetime="2018-05" class="refDate">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8375">https://www.rfc-editor.org/rfc/rfc8375</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC990">[RFC990]</dt>
        <dd>
<span class="refAuthor">Reynolds, J.</span> and <span class="refAuthor">J. Postel</span>, <span class="refTitle">"Assigned numbers"</span>, <span class="seriesInfo">RFC 990</span>, <span class="seriesInfo">DOI 10.17487/RFC0990</span>, <time datetime="1986-11" class="refDate">November 1986</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc990">https://www.rfc-editor.org/rfc/rfc990</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="secure-context">[secure-context]</dt>
      <dd>
<span class="refAuthor">W3C</span>, <span class="refTitle">"Web Platform Design Principles"</span>, <time datetime="2024-06" class="refDate">June 2024</time>, <span>&lt;<a href="https://w3ctag.github.io/design-principles/#secure-context">https://w3ctag.github.io/design-principles/#secure-context</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="discussion-points">
<section id="appendix-A">
      <h2 id="name-discussion-points">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-discussion-points" class="section-name selfRef">Discussion Points</a>
      </h2>
<div id="dtls">
<section id="appendix-A.1">
        <h3 id="name-dtls">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-dtls" class="section-name selfRef">DTLS</a>
        </h3>
<p id="appendix-A.1-1">This should work for DTLS, as well?<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="test-encoding">
<section id="appendix-B">
      <h2 id="name-test-encoding">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-test-encoding" class="section-name selfRef">Test Encoding</a>
      </h2>
<p id="appendix-B-1">Server with private key in PEM format is:<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B-2">
<pre>
-----BEGIN PRIVATE KEY-----
MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQCOkTU8TOKW/IZ6
whhyhg+1I4u0jm019z4SVUKAwKyOtFPtoEvRGPdKYUoLaPZmVyN/VTYlubVn7dE8
IYpibwkDhs38DKmyo0vdWjUaopQOaygtLB+PZ12l/XaSCE1cWsl45ShUvktcVR/D
DKwv7DWEIZrRTLKy6M+8Ne4x++kKXmwbSj8WsNQ4kU4uFhS+JXHXToZvhvoQLkTs
486XXPn4SJPLyTN62b6KHTLM1vb7RY4i4U7N6hS1UWe7bIxZNZ0vnf4vZ7A6SR7W
nM31DoaW5XCBH7CL56MSdn7dmuksRimfNmnsEmvBXZmuQMHnUZghBLMHPC9xmHhT
8q3pSY5jAgMBAAECggEANiAY1vDVob7zi01/HJObCQkatAzSl4drUGiAHAOKP49k
wbV2s0bIM7vl8ZkC2u3AM0p1iTMNFQzrv+l38VD4WhdmwodIMeLfHYVu3dLVZPf3
w9aZkMcMfcVRq7VtMV/iV3ygqDOqxr4mldWM1ZDW7HgZn9Z/jX7nxyuuZ9mcquuH
Brl8pcUba7666jcz+F9NNjXTPCwfm7ihCPkTeYr1NflQGTR5PJ+D5dywb53iulm1
ZTk2zBXJMujbIyTL0p+MqdEKXci7oQJqf7bQsxsO2ZUD24CmzYldsE6vmYUFxJpw
ZbYzO/a/Mv0mXQhcUTWKkJkU78QT2Us7SuSL+IPGSQKBgQDC5iRKtlYulUgxV9gu
TmX30R0W7R0nnsEjolNAqUwcIoUMHk8ODXEsp7jVOSFMJhHRMXL+VKYiBsiIV7vk
GlTbLRP34HgK54auRF6PTxBfNAkF+FQxl2mzWxj7wi5mg0g+tCJTLereUXULz8+r
h5Vqp4BCjcoumlyY0xlLtbr9/wKBgQC7Qx2Lb70XCL5eivdokMh2lRint9cfxC2W
fJ6QOnJgsN9XIQGTUAk3cLvmrKg3UOmJXXq+Q6djVB/3Op3+TFzsGS2ORMel9r6o
kAHYG/qdairlW9uTDsnwUP8UtE0lidhSXLGIAy71eMDbDg/c/yyrWTvysXf5kAiJ
CzTnyvY3nQKBgBt+Va5IbH3jxyxWxQM7Qf0kfaMHTe6R4ZMCShY8C6WIZRZhjCti
UA3JlzRU+9J/KFJHVH52OH1iUZWSMsopwMCuaju0aZq4MHKS6Hf04k1bzM4Pyui4
AEwx1KNnMB579IwL4y+ysYgtG4LQDO6YkMZb3KcG03ehhOB2HwJkH33HAoGATOw3
8bQ3v4OG970r/lcjEZsTYqnhA5qJg3yzgdmQbGmbhOX5CLNi5dQ4S3x3KSnilNvC
dO/DjcjbzKnWhsSFkzKQhRV50ZH3JbTqHQT5QLqA3nCKVPFJQJ90+ONLoXTrWIHd
J1rvakRtLE6tc4GartRcDMib2PcymmDxHZpA4/0CgYEAs0XF1G0gmnef8oEYuwZT
c+vr4wnD7YCP1h8nsNSgRHLk1e7k727iHGvruX3qrKsY26RHKi2+i1P6A39I4F5s
3Dme4HGXTyoc/qKp+/GAx5XYVG4c3Z3sdBejkpkhPTSlsSsDOHbjaiFV1zCyEdg5
fOPfIBX8uLc3UtOm0+Gn1IQ=
-----END PRIVATE KEY-----
</pre><a href="#appendix-B-2" class="pilcrow">¶</a>
</div>
<p id="appendix-B-3">and public key in PEM format is:<a href="#appendix-B-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B-4">
<pre>
-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAjpE1PEzilvyGesIYcoYP
tSOLtI5tNfc+ElVCgMCsjrRT7aBL0Rj3SmFKC2j2Zlcjf1U2Jbm1Z+3RPCGKYm8J
A4bN/AypsqNL3Vo1GqKUDmsoLSwfj2ddpf12kghNXFrJeOUoVL5LXFUfwwysL+w1
hCGa0UyysujPvDXuMfvpCl5sG0o/FrDUOJFOLhYUviVx106Gb4b6EC5E7OPOl1z5
+EiTy8kzetm+ih0yzNb2+0WOIuFOzeoUtVFnu2yMWTWdL53+L2ewOkke1pzN9Q6G
luVwgR+wi+ejEnZ+3ZrpLEYpnzZp7BJrwV2ZrkDB51GYIQSzBzwvcZh4U/Kt6UmO
YwIDAQAB
-----END PUBLIC KEY-----
</pre><a href="#appendix-B-4" class="pilcrow">¶</a>
</div>
<p id="appendix-B-5">Using the binary format (DER) and hashed using SHA256 gives this
hex value:<a href="#appendix-B-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B-6">
<pre>
21ebc0d00e98e3cb289738e2c091e532c4ad8240e0365b22067a1449693e5a18
</pre><a href="#appendix-B-6" class="pilcrow">¶</a>
</div>
<p id="appendix-B-7">Converting that hex value to binary and base32 encoded (without
trailing "=") gives:<a href="#appendix-B-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B-8">
<pre>
EHV4BUAOTDR4WKEXHDRMBEPFGLCK3ASA4A3FWIQGPIKES2J6LIMA
</pre><a href="#appendix-B-8" class="pilcrow">¶</a>
</div>
<p id="appendix-B-9">After the hash algorithm identification digit (0 for SHA512/256) is
prefixed to that base64url, resulting in:<a href="#appendix-B-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B-10">
<pre>
0EHV4BUAOTDR4WKEXHDRMBEPFGLCK3ASA4A3FWIQGPIKES2J6LIMA
</pre><a href="#appendix-B-10" class="pilcrow">¶</a>
</div>
<p id="appendix-B-11">Finally, if this is a printer named "printer" advertised using
".local", the full FQDN for its unique name would be:<a href="#appendix-B-11" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B-12">
<pre>
printer.0EHV4BUAOTDR4WKEXHDRMBEPFGLCK3ASA4A3FWIQGPIKES2J6LIMA.local
</pre><a href="#appendix-B-12" class="pilcrow">¶</a>
</div>
<p id="appendix-B-13">and the full FQDN for its short name would be "printer.local".<a href="#appendix-B-13" class="pilcrow">¶</a></p>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-C">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-C-1">This Internet Draft started as a document published by Martin
Thomson in 2007.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Martin Thomson</span></div>
<div dir="auto" class="left"><span class="org">Mozilla</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mt@lowentropy.net" class="email">mt@lowentropy.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Dan Wing (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Cloud Software Group Holdings, Inc.</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:danwing@gmail.com" class="email">danwing@gmail.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
